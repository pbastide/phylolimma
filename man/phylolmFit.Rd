% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/phylolmFit.R
\name{phylolmFit}
\alias{phylolmFit}
\title{Phylogenetic COmparative Method using LIMMA}
\usage{
phylolmFit(
  object,
  design = NULL,
  phy,
  model = c("BM", "lambda", "OUfixedRoot", "delta"),
  measurement_error = FALSE,
  use_consensus = TRUE,
  consensus_tree = NULL,
  ddf_method = c("Satterthwaite", "Species", "Samples"),
  REML = TRUE,
  ...
)
}
\arguments{
\item{object}{A matrix data object containing normalized expression values,
with rows corresponding to genes and columns to samples (species).}

\item{design}{the design matrix of the experiment,
with rows corresponding to samples and columns to coefficients to be estimated.
Defaults to the unit vector (intercept).}

\item{phy}{an object of class \code{\link[ape]{phylo}},
with tips having the same names as the columns of \code{object}.}

\item{model}{the phylogenetic model used to correct for the phylogeny.
Must be one of "BM", "lambda", "OUfixedRoot" or "delta".
See \code{\link[phylolm]{phylolm}} for more details.}

\item{measurement_error}{a logical value indicating whether there is measurement error.
Default to \code{TRUE}.
See \code{\link[phylolm]{phylolm}} for more details.}

\item{use_consensus}{If \code{TRUE}, one consensus tree is used to represent the correlation structure. see \code{\link{phylogeneticCorrelations}}.
If \code{FALSE}, each gene will use its own model parameters and will have its own correlation structure accordingly.
Default to TRUE.}

\item{consensus_tree}{If not \code{NULL}, the consensus tree containing the correlation structure,
result of function \code{\link{phylogeneticCorrelations}}.
If provided, arguments \code{phy}, \code{model} and \code{measurement_error} will be ignored.}

\item{ddf_method}{the method for the computation of the degrees of freedom of the t statistics (before moderation).
Default to \code{ddf_method="Satterthwaite"}.
If \code{ddf_method="Species"}, then the number of species is taken for the
computation of the degrees of freedom,
while if \code{ddf_method="Samples"} the total number of individuals is used.}

\item{REML}{Use REML (default) or ML for estimating the parameters.}

\item{...}{further parameters to be passed
to \code{\link[limma]{lmFit}} or \code{\link[phylolm]{phylolm}}.}
}
\value{
An object of class \code{\link[limma]{MArrayLM-class}},
with list components \code{coefficients}, \code{stdev.unscaled},
\code{sigma} and \code{df.residual}.
These quantities take the phylogenetic model into account.
The object can be passed to \code{\link[limma]{eBayes}}.
}
\description{
This function applies \code{\link[limma]{lmFit}} to the normalized data,
in order to take the phylogeny into account.
TODO: explain more.
}
\details{
The default bounds on the phylogenetic parameters are the same as in
\code{\link[phylolm]{phylolm}}, except for the \code{alpha} parameter of the OU.
}
