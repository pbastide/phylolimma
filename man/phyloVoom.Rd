% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/phyloVoom.R
\name{phyloVoom}
\alias{phyloVoom}
\title{Transform RNA-Seq Data Ready for Linear Modelling}
\usage{
phyloVoom(
  counts,
  lengthMatrix = NULL,
  normalisationFactor = NULL,
  lengthNormalization = c("TPM", "RPKM", "none"),
  dataTransformation = "log2",
  design = NULL,
  phy,
  model = c("BM", "lambda", "OUfixedRoot", "delta"),
  measurement_error = TRUE,
  weights = NULL,
  span = 0.5,
  plot = FALSE,
  save.plot = FALSE,
  ...
)
}
\arguments{
\item{counts}{
    a numeric \code{matrix} containing raw counts, or an \code{ExpressionSet} containing raw counts, or a \code{DGEList} object.
    Counts must be non-negative and NAs are not permitted.}

\item{lengthMatrix}{The associated length matrix. Should have the same dimensions as \code{countMatrix}, with the same names.}

\item{normalisationFactor}{Normalization factors to scale the raw library sizes, as computed e.g. by \code{\link[edgeR]{calcNormFactors}}.}

\item{lengthNormalization}{one of "none" (no correction), "TPM" (default) or "RPKM". See details.}

\item{dataTransformation}{one of "log2", "asin(sqrt)" or "sqrt." See details.}

\item{design}{
    design matrix with rows corresponding to samples and columns to coefficients to be estimated.
    Defaults to the unit vector meaning that samples are treated as replicates.}

\item{phy}{an object of class \code{\link[ape]{phylo}},
with tips having the same names as the columns of \code{object}.}

\item{model}{the phylogenetic model used to correct for the phylogeny.
Must be one of "BM", "lambda", "OUfixedRoot" or "delta".
See \code{\link[phylolm]{phylolm}} for more details.}

\item{measurement_error}{a logical value indicating whether there is measurement error.
See \code{\link[phylolm]{phylolm}} for more details.}

\item{weights}{
    prior weights.
    Can be a numeric matrix of individual weights of same dimensions as the \code{counts},
    or a numeric vector of sample weights with length equal to \code{ncol(counts)},
    or a numeric vector of gene weights with length equal to \code{nrow(counts)}.}

\item{span}{
    width of the smoothing window used for the lowess mean-variance trend.
    Expressed as a proportion between 0 and 1.}

\item{plot}{
    logical, should a plot of the mean-variance trend be displayed?}

\item{save.plot}{
    logical, should the coordinates and line of the plot be saved in the output?}

\item{...}{further parameters to be passed to \code{\link{phylolmFit}}.}
}
\value{
A matrix of normalized and transformed counts, with the same dimensions as \code{counts}.
}
\description{
Normalize and transform count data,
estimate the mean-variance relationship
and use this to compute appropriate observation-level weights.
The data are then ready for phylogenetic linear modeling.
}
\details{
See details of the data normalization and transformation in function
\code{\link{lengthNormalizeRNASeq}}.
}
