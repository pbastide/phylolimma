% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/phylogeneticCorrelations.R
\name{phylogeneticCorrelations}
\alias{phylogeneticCorrelations}
\title{Phylogenetic COmparative Method using LIMMA}
\usage{
phylogeneticCorrelations(
  object,
  design = NULL,
  phy,
  model = c("BM", "lambda", "OUfixedRoot", "delta"),
  measurement_error = TRUE,
  trim = 0.15,
  weights = NULL,
  ...
)
}
\arguments{
\item{object}{A matrix data object containing normalized expression values,
with rows corresponding to genes and columns to samples (species).}

\item{design}{the design matrix of the experiment,
with rows corresponding to samples and columns to coefficients to be estimated.
Defaults to the unit vector (intercept).}

\item{phy}{an object of class \code{\link[ape]{phylo}},
with tips having the same names as the columns of \code{object}.}

\item{model}{the phylogenetic model used to correct for the phylogeny.
Must be one of "BM", "lambda", "OUfixedRoot" or "delta".
See \code{\link[phylolm]{phylolm}} for more details.}

\item{measurement_error}{a logical value indicating whether there is measurement error.
Default to \code{TRUE}.
See \code{\link[phylolm]{phylolm}} for more details.}

\item{trim}{the fraction of observations to be trimmed from each end when computing the trimmed mean. Default to 0.15, as in \code{\link[limma]{duplicateCorrelation}}.}

\item{weights}{a named vector or matrix with weights to be applied on the measurement error term.
See \code{\link[phylolm]{phylolm}} for more details.}

\item{...}{further parameters to be passed
to \code{\link[limma]{lmFit}}.}
}
\value{
An object of class \code{TransTree-class},
with list components:
\itemize{
\item \code{tree} the transformed consensus tree
\item \code{params} the associated consensus parameters.
}
This consensus tree define a correlation structure, and can be passed on to \code{\link[limma]{lmFit}}.
}
\description{
This function applies \code{\link[limma]{lmFit}} to the normalized data,
in order to take the phylogeny into account.
TODO: explain more.
}
\seealso{
\code{\link[limma]{lmFit}}, \code{\link[phylolm]{phylolm}}, \code{\link[limma]{duplicateCorrelation}}
}
